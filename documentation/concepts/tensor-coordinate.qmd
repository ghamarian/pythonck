---
title: "Tensor Coordinates"
format: live-html
---

```{pyodide}
#| echo: false
#| output: false
#| autorun: true

# Auto-install pythonck package
import micropip
await micropip.install("https://raw.githubusercontent.com/ghamarian/pythonck/master/documentation/pythonck-0.1.0-py3-none-any.whl")
```

# Tensor Coordinates

Tensor coordinates provide a powerful abstraction for multi-dimensional indexing with support for complex transformations. They form the foundation for all tensor operations in PythonCK.

## Core Components

### MultiIndex
A `MultiIndex` represents a multi-dimensional index with a specific number of dimensions:

```{pyodide}
#| echo: true
#| output: true

from pytensor.tensor_coordinate import MultiIndex

# Create a 3D index
idx = MultiIndex(3, [2, 1, 4])
print(f"3D index: {idx}")
print(f"Dimensions: {idx.get_ndim()}")
print(f"Values: {idx.to_list()}")
```

### TensorCoordinate
A `TensorCoordinate` extends `MultiIndex` with transformation capabilities:

```{pyodide}
#| echo: true
#| output: true

from pytensor.tensor_coordinate import TensorCoordinate, MultiIndex

# Create a tensor coordinate
multi_idx = MultiIndex(3, [1, 2, 3])
coord = TensorCoordinate(multi_idx)

print(f"Tensor coordinate: {coord}")
print(f"Underlying index: {coord.get_index()}")
```

## Key Operations

### Index Manipulation

```{pyodide}
#| echo: true
#| output: true

# Create and manipulate indices
idx1 = MultiIndex(2, [3, 7])
idx2 = MultiIndex(2, [1, 2])

print(f"Original: {idx1}")
print(f"Offset: {idx2}")

# Element-wise operations
result = MultiIndex(2, [idx1[i] + idx2[i] for i in range(2)])
print(f"Sum: {result}")
```

### Coordinate Transformations

```{pyodide}
#| echo: true
#| output: true

from pytensor.tensor_coordinate import make_tensor_adaptor_coordinate

# Create a coordinate with transformations
# This demonstrates how coordinates can be transformed through adaptor chains
coord = make_tensor_adaptor_coordinate(
    adaptor=None,  # No adaptor for this simple example
    multi_index=MultiIndex(2, [5, 3])
)

print(f"Adaptor coordinate: {coord}")
print(f"Bottom index: {coord.get_bottom_index()}")
```

## Relationship to Other Concepts

Tensor coordinates are used throughout PythonCK:

- **Buffer Views** use coordinates to access memory locations
- **Tensor Descriptors** transform coordinates through layout changes  
- **Tile Distributions** map coordinates between different spaces
- **Sweep Operations** iterate through coordinate ranges

## Next Steps

- Explore [Buffer Views](buffer-view.qmd) to see how coordinates access memory
- Learn about [Tensor Descriptors](tensor-descriptor.qmd) for coordinate transformations
- Understand [Tile Distribution](tile-distribution.qmd) for parallel coordinate mapping

The coordinate system provides the mathematical foundation that enables all the advanced tensor operations in PythonCK. 